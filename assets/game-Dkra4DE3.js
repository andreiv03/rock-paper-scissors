import{r as s,j as o,a as L,L as S,u as G,I as j,g as w,G as O}from"./index-BgO9Pz0-.js";import{M as U,u as N,P as W,a as Y,m as P}from"./proxy-B5FX1OqI.js";class A extends s.Component{getSnapshotBeforeUpdate(a){const t=this.props.childRef.current;if(t&&a.isPresent&&!this.props.isPresent){const r=t.offsetParent,d=r instanceof HTMLElement&&r.offsetWidth||0,i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft,i.right=d-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function D({children:e,isPresent:a,anchorX:t}){const r=s.useId(),d=s.useRef(null),i=s.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:u}=s.useContext(U);return s.useInsertionEffect(()=>{const{width:g,height:c,top:_,left:n,right:l}=i.current;if(a||!d.current||!g||!c)return;const f=t==="left"?`left: ${n}`:`right: ${l}`;d.current.dataset.motionPopId=r;const p=document.createElement("style");return u&&(p.nonce=u),document.head.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${g}px !important;
            height: ${c}px !important;
            ${f}px !important;
            top: ${_}px !important;
          }
        `),()=>{document.head.removeChild(p)}},[a]),o.jsx(A,{isPresent:a,childRef:d,sizeRef:i,children:s.cloneElement(e,{ref:d})})}const K=({children:e,initial:a,isPresent:t,onExitComplete:r,custom:d,presenceAffectsLayout:i,mode:u,anchorX:g})=>{const c=N(B),_=s.useId(),n=s.useCallback(f=>{c.set(f,!0);for(const p of c.values())if(!p)return;r&&r()},[c,r]),l=s.useMemo(()=>({id:_,initial:a,isPresent:t,custom:d,onExitComplete:n,register:f=>(c.set(f,!1),()=>c.delete(f))}),i?[Math.random(),n]:[t,n]);return s.useMemo(()=>{c.forEach((f,p)=>c.set(p,!1))},[t]),s.useEffect(()=>{!t&&!c.size&&r&&r()},[t]),u==="popLayout"&&(e=o.jsx(D,{isPresent:t,anchorX:g,children:e})),o.jsx(W.Provider,{value:l,children:e})};function B(){return new Map}const R=e=>e.key||"";function b(e){const a=[];return s.Children.forEach(e,t=>{s.isValidElement(t)&&a.push(t)}),a}const F=({children:e,custom:a,initial:t=!0,onExitComplete:r,presenceAffectsLayout:d=!0,mode:i="sync",propagate:u=!1,anchorX:g="left"})=>{const[c,_]=Y(u),n=s.useMemo(()=>b(e),[e]),l=u&&!c?[]:n.map(R),f=s.useRef(!0),p=s.useRef(n),v=N(()=>new Map),[T,z]=s.useState(n),[C,$]=s.useState(n);L(()=>{f.current=!1,p.current=n;for(let x=0;x<C.length;x++){const h=R(C[x]);l.includes(h)?v.delete(h):v.get(h)!==!0&&v.set(h,!1)}},[C,l.length,l.join("-")]);const E=[];if(n!==T){let x=[...n];for(let h=0;h<C.length;h++){const y=C[h],M=R(y);l.includes(M)||(x.splice(h,0,y),E.push(y))}return i==="wait"&&E.length&&(x=E),$(b(x)),z(n),null}const{forceRender:I}=s.useContext(S);return o.jsx(o.Fragment,{children:C.map(x=>{const h=R(x),y=u&&!c?!1:n===C||l.includes(h),M=()=>{if(v.has(h))v.set(h,!0);else return;let k=!0;v.forEach(H=>{H||(k=!1)}),k&&(I==null||I(),$(p.current),u&&(_==null||_()),r&&r())};return o.jsx(K,{isPresent:y,initial:!f.current||t?void 0:!1,custom:a,presenceAffectsLayout:d,mode:i,onExitComplete:y?void 0:M,anchorX:g,children:x},h)})})},V="_game_a11fd_1",X="_container_a11fd_7",q="_larger_a11fd_15",J="_user_a11fd_18",Q="_house_a11fd_22",Z="_visible_a11fd_37",ee="_item_a11fd_41",se="_rock_a11fd_52",te="_paper_a11fd_58",ne="_scissors_a11fd_64",oe="_results_a11fd_74",ie="_button_a11fd_89",m={game:V,container:X,larger:q,user:J,house:Q,visible:Z,item:ee,rock:se,paper:te,scissors:ne,results:oe,button:ie},ae=()=>{const{state:e,setChoices:a,setWinner:t,playAgain:r}=G(O),[d,i]=s.useState(!1),[u,g]=s.useState(!1);s.useEffect(()=>{if(!e.choices.user)return;const n=setTimeout(()=>{const l=j[Math.floor(Math.random()*j.length)];a({user:e.choices.user,house:l}),g(!0)},1e3);return i(!0),()=>clearTimeout(n)},[e.choices.user,a]),s.useEffect(()=>{if(!u||!e.choices.user||!e.choices.house)return;const n=j.indexOf(e.choices.user),l=j.indexOf(e.choices.house);if(n===-1||l===-1)return;const f=(n-l+j.length)%j.length;t(f===1?"user":f===2?"house":null)},[u,e.choices.user,e.choices.house,t]);const c=()=>e.winner==="user"?"You win":e.winner==="house"?"You lose":"Tie",_=()=>{r(),i(!1),g(!1)};return o.jsx("div",{className:m.game,children:o.jsxs("div",{className:`${m.container} ${u?m.larger:""}`,children:[o.jsxs("div",{className:m.user,children:[o.jsx("h3",{className:d?m.visible:"",children:"You picked"}),o.jsx(P.div,{className:`${m.item} ${m[e.choices.user]}`,layoutId:e.choices.user,children:o.jsx("img",{alt:e.choices.user,src:w(e.choices.user)})})]}),o.jsx(F,{children:u&&o.jsxs(P.div,{className:m.results,initial:{opacity:0},animate:{opacity:1,transition:{duration:.3,ease:"easeInOut"}},children:[o.jsx("h3",{children:c()}),o.jsx("div",{className:m.button,onClick:_,children:"Play again"})]})}),o.jsxs("div",{className:m.house,children:[o.jsx("h3",{className:d?m.visible:"",children:"House picked"}),o.jsx(P.div,{className:`${m.item} ${m[e.choices.house]}`,initial:{scale:0},animate:{scale:1,transition:{duration:.3,ease:"easeInOut"}},children:e.choices.house&&o.jsx("img",{alt:e.choices.house,src:w(e.choices.house)})})]})]})})};export{ae as default};
